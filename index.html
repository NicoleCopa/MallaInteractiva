<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Malla Curricular â€“ AnÃ¡lisis de Sistemas</title>
<style>
  :root{
    /* Paleta (suave) basada en la imagen: */
    --slate-900:#4f5474;   /* encabezados / acentos oscuros */
    --slate-400:#9aa4bd;   /* cards y bordes suaves          */
    --sand-200:#e4dac8;    /* fondo columnas / chips         */
    --sand-100:#f6efd8;    /* fondo general                  */
    --ok:#2e7d32;          /* aprobado */
    --locked:#b00020;      /* bloqueado */
    --txt:#263238;
    --muted:#556;
    --radius:16px;
    --shadow: 0 8px 24px rgba(0,0,0,.08), 0 2px 6px rgba(0,0,0,.04);
  }

  html,body{height:100%}
  body{
    margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",Arial;
    color:var(--txt);
    background: linear-gradient(180deg,var(--sand-100),#fff 320px);
  }

  header{
    padding:28px 16px 8px;
    text-align:center;
  }
  h1{
    margin:0; font-size:clamp(22px,2.6vw,32px);
    color:#fff; letter-spacing:.3px;
    background:var(--slate-900);
    border-radius:calc(var(--radius) + 6px);
    display:inline-block;
    padding:14px 18px;
    box-shadow:var(--shadow);
  }
  .sub{
    margin:12px auto 0;
    color:var(--muted);
    max-width:900px;
    font-size:14px;
  }

  .toolbar{
    display:flex; gap:8px; justify-content:center; align-items:center;
    margin:18px auto 10px; flex-wrap:wrap;
  }
  .btn{
    border:0; border-radius:999px; padding:10px 14px; cursor:pointer;
    background:var(--sand-200); color:#3b3f58; box-shadow:var(--shadow);
    font-weight:600;
  }
  .btn:active{transform:translateY(1px)}
  .legend{display:flex; gap:12px; flex-wrap:wrap; align-items:center}
  .dot{width:10px;height:10px;border-radius:999px;display:inline-block;margin-right:6px}
  .d-done{background:var(--ok)}
  .d-available{background:#607d8b}
  .d-locked{background:var(--locked)}

  .grid{
    display:grid; gap:16px;
    grid-template-columns: repeat(3, minmax(240px,1fr));
    align-items:start;
    padding:16px; max-width:1200px; margin:0 auto 40px;
  }
  .col{
    background: #ffffffc0;
    border:1px solid #ece7da;
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    min-height:120px;
    overflow:hidden;
  }
  .col-title{
    margin:0; padding:14px 16px; font-size:18px; color:#fff;
    background:linear-gradient(180deg,var(--slate-900),#6a7196);
    position:sticky; top:0; z-index:2;
  }
  .bucket{ padding:12px }

  .course{
    position:relative;
    border-radius:14px;
    border:1px solid rgba(0,0,0,.06);
    background:linear-gradient(180deg,#fff, #f9fafc);
    box-shadow:0 1px 0 rgba(0,0,0,.05);
    padding:12px 12px 12px 44px;
    margin:10px 0;
    transition:.2s transform ease,.2s box-shadow ease;
    cursor:pointer;
  }
  .course:hover{ box-shadow:0 10px 20px rgba(0,0,0,.08); transform:translateY(-1px) }
  .course h4{
    margin:0 0 6px; font-size:15px; line-height:1.25; font-weight:700; color:#2b2f49;
  }
  .meta{
    display:flex; gap:8px; flex-wrap:wrap; font-size:12px; color:#556;
  }
  .chip{
    padding:3px 8px; border-radius:999px; background:var(--sand-200);
    border:1px solid #e6decc;
  }

  /* Estado visual */
  .course.locked{ opacity:.65; cursor:not-allowed; }
  .course.locked:hover{ transform:none; box-shadow:0 1px 0 rgba(0,0,0,.05) }
  .course.locked::after{
    content:"ðŸ”’"; position:absolute; left:12px; top:12px; font-size:18px;
  }
  .course.available::after{
    content:"â—‹"; position:absolute; left:12px; top:11px; font-size:18px; color:#607d8b;
  }
  .course.done{
    background:linear-gradient(180deg,#f7fff8,#f2fff3);
    border-color:#d7efd9;
  }
  .course.done::after{
    content:"âœ”"; position:absolute; left:12px; top:11px; font-size:18px; color:var(--ok);
  }
  .course small.code{ color:#7b84a3; font-weight:600; letter-spacing:.2px }

  /* Tooltip simple (usa atributo title nativo, pero aÃ±adimos estilo accesible opcional) */
  .course[data-tip]{
    position:relative;
  }
  .course.locked:hover::before{
    content:attr(data-tip);
    position:absolute; left:44px; right:12px; bottom:100%;
    transform:translateY(-6px);
    background:#1f243b; color:#fff; padding:8px 10px; border-radius:10px;
    font-size:12px; white-space:pre-wrap; line-height:1.25;
    box-shadow:var(--shadow);
  }
  .course.locked:hover::after{
    /* reemplazamos el icono por el triangulito del tooltip cuando hay hover */
    content:""; position:absolute; left:56px; bottom:calc(100% - 6px);
    width:10px; height:10px; transform:rotate(45deg);
    background:#1f243b;
    box-shadow:-1px -1px 0 rgba(0,0,0,.06);
  }

  @media (max-width:960px){
    .grid{ grid-template-columns: 1fr; }
    .col-title{ position:sticky }
  }
</style>
</head>
<body>
<header>
  <h1>Malla â€“ Tecnicatura en AnÃ¡lisis de Sistemas</h1>
  <div class="sub">HacÃ© clic en cada materia para marcarla como <b>aprobada</b>. 
    Las que tienen correlativas aparecen <b>bloqueadas</b> hasta cumplir los requisitos.
    Tu progreso se guarda automÃ¡ticamente en este dispositivo.
  </div>
  <div class="toolbar">
    <div class="legend">
      <span class="dot d-available"></span>Disponible
      <span class="dot d-locked"></span>Bloqueada
      <span class="dot d-done"></span>Aprobada
    </div>
    <button id="btn-reset" class="btn" title="Borrar el progreso guardado">Reiniciar progreso</button>
  </div>
</header>

<main class="grid" id="grid"></main>

<script>
/* ====================== Datos del Plan ====================== */
/* Estructura: id, codigo, nombre, anio (1..3), periodo ('1Â° Cuat.' | '2Â° Cuat.'), correlativas:[ids] */
const PLAN = [
  // 1Â° aÃ±o
  {id:"1.1.1", codigo:"1.1.1", nombre:"TÃ©cnicas de ProgramaciÃ³n", anio:1, periodo:"1Â° Cuat.", req:[]},
  {id:"1.1.2", codigo:"1.1.2", nombre:"Elementos de AnÃ¡lisis MatemÃ¡tico", anio:1, periodo:"1Â° Cuat.", req:[]},
  {id:"1.1.3", codigo:"1.1.3", nombre:"AdministraciÃ³n y GestiÃ³n de Bases de Datos", anio:1, periodo:"1Â° Cuat.", req:[]},
  {id:"1.1.4", codigo:"1.1.4", nombre:"LÃ³gica Computacional", anio:1, periodo:"1Â° Cuat.", req:[]},

  {id:"1.2.1", codigo:"1.2.1", nombre:"Desarrollo de Sistemas Orientado a Objetos", anio:1, periodo:"2Â° Cuat.", req:["1.1.1","1.1.3","1.1.4"]},
  {id:"1.2.2", codigo:"1.2.2", nombre:"EstadÃ­stica y Probabilidad para el AnÃ¡lisis de Sistemas", anio:1, periodo:"2Â° Cuat.", req:[]},
  {id:"1.2.3", codigo:"1.2.3", nombre:"Modelado y DiseÃ±o de Software", anio:1, periodo:"2Â° Cuat.", req:["1.1.1"]},
  {id:"1.2.4", codigo:"1.2.4", nombre:"InglÃ©s", anio:1, periodo:"2Â° Cuat.", req:[]},
  {id:"1.2.5", codigo:"1.2.5", nombre:"PPI: AproximaciÃ³n al campo laboral", anio:1, periodo:"2Â° Cuat.", req:[]},

  // 2Â° aÃ±o
  {id:"2.1.1", codigo:"2.1.1", nombre:"AnÃ¡lisis de Sistemas", anio:2, periodo:"1Â° Cuat.", req:[]},
  {id:"2.1.2", codigo:"2.1.2", nombre:"IngenierÃ­a de Software", anio:2, periodo:"1Â° Cuat.", req:[]},
  {id:"2.1.3", codigo:"2.1.3", nombre:"Taller de ComunicaciÃ³n", anio:2, periodo:"1Â° Cuat.", req:[]},
  {id:"2.1.4", codigo:"2.1.4", nombre:"DiseÃ±o e ImplementaciÃ³n de Pruebas de Software", anio:2, periodo:"1Â° Cuat.", req:["1.2.1"]},
  {id:"2.1.5", codigo:"2.1.5", nombre:"PPII: Relevamiento de requerimientos de usuario", anio:2, periodo:"1Â° Cuat.", req:[]},

  {id:"2.2.1", codigo:"2.2.1", nombre:"Trabajo, TecnologÃ­a y Sociedad", anio:2, periodo:"2Â° Cuat.", req:[]},
  {id:"2.2.2", codigo:"2.2.2", nombre:"Redes y Ciberseguridad", anio:2, periodo:"2Â° Cuat.", req:[]},
  {id:"2.2.3", codigo:"2.2.3", nombre:"GestiÃ³n de Proyectos", anio:2, periodo:"2Â° Cuat.", req:[]},
  {id:"2.2.4", codigo:"2.2.4", nombre:"Seminario de ActualizaciÃ³n en TecnologÃ­a Web", anio:2, periodo:"2Â° Cuat.", req:["1.2.1"]},
  {id:"2.2.5", codigo:"2.2.5", nombre:"PPIII: DiseÃ±o y arquitectura de sistemas", anio:2, periodo:"2Â° Cuat.", req:[]},

  // 3Â° aÃ±o
  {id:"3.1.1", codigo:"3.1.1", nombre:"Sistemas de GestiÃ³n", anio:3, periodo:"1Â° Cuat.", req:["1.1.3"]},
  {id:"3.1.2", codigo:"3.1.2", nombre:"Liderazgo y GestiÃ³n de Equipos", anio:3, periodo:"1Â° Cuat.", req:["2.1.1","2.1.2"]},
  {id:"3.1.3", codigo:"3.1.3", nombre:"Aseguramiento de Calidad de los Sistemas", anio:3, periodo:"1Â° Cuat.", req:["2.1.4"]},
  {id:"3.1.4", codigo:"3.1.4", nombre:"Arquitectura de Sistemas en la Nube", anio:3, periodo:"1Â° Cuat.", req:["2.2.2"]},
  {id:"3.1.5", codigo:"3.1.5", nombre:"PPIV: Proyecto integrador", anio:3, periodo:"1Â° Cuat.", req:["2.1.5","2.2.5"]},
];

const STORAGE_KEY = "malla-asis-v1";

/* ====================== Utilidades ====================== */
const $ = sel => document.querySelector(sel);
const el = (tag, attrs={}, ...children)=>{
  const n = document.createElement(tag);
  Object.entries(attrs).forEach(([k,v])=>{
    if(k==="class") n.className = v;
    else if(k==="dataset") Object.assign(n.dataset, v);
    else if(k.startsWith("on") && typeof v==="function") n.addEventListener(k.slice(2), v);
    else if(v!==null && v!==undefined) n.setAttribute(k, v);
  });
  for(const c of children){
    if(c==null) continue;
    n.appendChild(typeof c==="string" ? document.createTextNode(c) : c);
  }
  return n;
};

function loadProgress(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? new Set(JSON.parse(raw)) : new Set();
  }catch{ return new Set(); }
}
function saveProgress(set){
  localStorage.setItem(STORAGE_KEY, JSON.stringify([...set]));
}

function missingOf(course, approvedSet){
  const missing = course.req.filter(r => !approvedSet.has(r));
  if(missing.length===0) return [];
  // Devolver nombres legibles
  const map = Object.fromEntries(PLAN.map(c=>[c.id, c]));
  return missing.map(id => `${id} â€“ ${map[id]?.nombre ?? ""}`.trim());
}

function periodOrder(p){ return p.startsWith("1") ? 1 : 2; }

/* ====================== Render ====================== */
function render(){
  const approved = loadProgress();

  const grid = $("#grid");
  grid.innerHTML = "";

  // Agrupar por aÃ±o
  for(const anio of [1,2,3]){
    const col = el("section",{class:"col"});
    col.appendChild(el("h3",{class:"col-title"}, `AÃ±o ${anio}Â°`));

    const bucket = el("div",{class:"bucket"});
    // ordenar por periodo 1Â° luego 2Â° manteniendo orden de carga
    const courses = PLAN.filter(c=>c.anio===anio)
      .sort((a,b)=>periodOrder(a.periodo)-periodOrder(b.periodo));

    for(const c of courses){
      const li = el("article",{class:"course", tabindex:"0", role:"button","aria-pressed":"false"});
      li.appendChild(el("h4",{}, c.nombre));
      li.appendChild(el("div",{class:"meta"},
        el("span",{class:"chip"}, c.periodo),
        el("span",{class:"chip"}, el("small",{class:"code"}, c.codigo))
      ));

      // Estado
      const faltantes = missingOf(c, approved);
      const isLocked = faltantes.length>0 && !approved.has(c.id);
      const isDone   = approved.has(c.id);

      li.classList.toggle("locked", isLocked);
      li.classList.toggle("done", isDone);
      li.classList.toggle("available", !isLocked && !isDone);

      if(isLocked){
        const tip = `Bloqueada: faltan\nâ€¢ ${faltantes.join("\nâ€¢ ")}`;
        li.setAttribute("title", tip);   // tooltip nativo
        li.dataset.tip = tip;            // tooltip bonito (hover)
        li.setAttribute("aria-disabled","true");
      }else{
        li.removeAttribute("title");
        li.removeAttribute("aria-disabled");
        li.removeAttribute("data-tip");
      }

      // InteracciÃ³n
      li.addEventListener("click",(ev)=>{
        if(li.classList.contains("locked")) return; // no permitir
        const set = loadProgress();
        if(set.has(c.id)) set.delete(c.id); else set.add(c.id);
        saveProgress(set);
        render(); // re-pintar para actualizar bloqueos/estados
      });
      li.addEventListener("keydown",(ev)=>{
        if(ev.key==="Enter" || ev.key===" "){ ev.preventDefault(); li.click(); }
      });

      bucket.appendChild(li);
    }

    col.appendChild(bucket);
    grid.appendChild(col);
  }
}

$("#btn-reset").addEventListener("click",()=>{
  if(confirm("Â¿Seguro que querÃ©s borrar todo el progreso guardado?")){
    localStorage.removeItem(STORAGE_KEY);
    render();
  }
});

// Inicializar
render();
</script>
</body>
</html>
